<div class="the-padding">
</div>


<div class="spec ">
	<h3>Service Details</h3>
	<div class="ser-t1">
		<b></b>
		<span><i></i></span>
		<b class="line"></b>
	</div>
</div>

<div class="single">
	<div class="container">
		<div class="single-top-main">
			<div class="col-md-5 single-top">
				<div class="single-w3agile">	
					<div id="picture-frame">
						<%= image_tag @service.picture.standard.url, class: "img-responsive" %>
					</div>
					<script>
						$(function() {
							$("#picture-frame").zoomToo({
								magnify: 1
							});
						});
					</script>
				</div>
			</div>
			<div class="col-md-7 single-top-left ">
				<div class="single-right">
					<%= link_to profile_path(@service.profile_id) do %>
						<h3><%= @service.profile.name_of_agency %></h3>
					<% end %>
					<div class="pr-single">
						<p class="reduced "><%= @service.price %></p>
					</div>
					<div class="block block-w3">
						<div class="starbox small ghosting"> </div>
					</div>
					<p class="in-pa"> <%= @service.desc_service %></p>
			   	
					<div class="style-textarea">
							<textarea id="body" row="10" col="10"></textarea>
							
						
					</div>

					
					<div class="add add-3">	
						<button id="message-supplier">Contact Supplier</button>
					</div>		 
				<div class="clearfix"> </div>
			</div>
		</div>
	<div class="clearfix"> </div>
</div>	
				 
				
	</div>
</div>

<div class="the-padding">
</div>

<script>

$('.message-mail').click(function(e){
		var messageId = $(this).attr('title');
		var messageForm = new FormData();
		messageForm.append('message[read]', 1);

		$.ajax({
		  url: "/messages/"+messageId,
		 type: "PATCH",
		 data: messageForm,
		cache: false,
  contentType: false,
  processData: false,
	  success: function(resp){ 
			console.log(resp);
			},
		 fail:  function(resp){
			console.log(resp);
	   		}
		});

	});

	
$('#message-supplier').click(function(e){
	e.preventDefault();
	var messageId = $(this).attr('title');
	var messageForm = new FormData();
	messageForm.append('message[body]', $('#body').val().trim());
	messageForm.append('message[profile_id]', <%= @service.profile_id %>);

$.ajax({
		url: "/messages/",
		type: "POST",
		data: messageForm,
	   cache: false,
 contentType: false,
 processData: false,
	 success: function(resp){ 
		console.log(resp);
		$('.single-top-left').prepend("<div class='alert alert-success' role='alert'> Message sent sucessfully!</div>");
		},
		fail:  function(resp){
		$('.single-top-left').prepend("<div class='alert alert-danger' role='alert'> You cannot send this message at this time!</div>");
		}
	});
});
</script>